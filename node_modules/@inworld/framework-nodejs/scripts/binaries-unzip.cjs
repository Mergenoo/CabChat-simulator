const extract = require('extract-zip');
const fs = require('fs');
const os = require('os');
const path = require('path');

async function unzipBinaries() {
  const platform = os.platform();
  const arch = os.arch();
  const platformArch = `${platform}_${arch}`;

  const sourceZip = path.join(__dirname, '..', 'bin', `${platformArch}.zip`);
  const targetDir = path.join(__dirname, '..', 'bin', platformArch);

  if (!fs.existsSync(sourceZip)) {
    throw new Error(`Unsupported platform: ${platform} ${arch}`);
  }

  fs.rmSync(targetDir, { recursive: true, force: true });

  await extract(sourceZip, { dir: targetDir });
}

unzipBinaries();
